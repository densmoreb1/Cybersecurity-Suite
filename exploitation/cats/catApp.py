import PySimpleGUI as sg
import os
import PyInstaller.__main__

def run_pyinstaller(name):
    PyInstaller.__main__.run([
        'catPictures.py',
        '--onefile',
        '--windowed',
        f'-n {name}'
    ])

sg.theme('Dark Grey 13')
sg.set_options(font='sans')

layout = [
    [sg.Text('Enter a name you would like the file')],
    [sg.Input()],
    [sg.B('Enter', bind_return_key=True)]
]


window = sg.Window('Program creator', layout)
while True:
    event, values = window.read()
    if event == sg.WIN_CLOSED or event == 'Exit':
        break
    elif event == 'Enter':
        run_pyinstaller(values[0])
        sg.popup("Done!", any_key_closes=True)
        window.close()
    elif event == 'Clear':
        window.find_element('out').Update('')

window.close()
