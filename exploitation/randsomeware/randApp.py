# create app that creates the files needed to run
# explain what it does and why it is dangerous

import PySimpleGUI as sg
import os
import PyInstaller.__main__

def run_pyinstaller(name):
    PyInstaller.__main__.run([
        'encryptor.py',
        '--onefile',
        '--windowed',
        f'-n {name}'
    ])

sg.theme('Dark Grey 13')
sg.set_options(font='sans')

sg.popup("This program will create a script to encrypt files.")
sg.popup("Be very carful running the program. The program will encrypt any file in the directory it is ran in.")
sg.popup("This will create two directories and a file called key.key")

layout = [
    [sg.Text('Enter the name you would like to name the file:')],
    [sg.Input()],
    [sg.B('Enter', bind_return_key=True)]
]

window = sg.Window('Program creator', layout)
while True:
    event, values = window.read()
    if event == sg.WIN_CLOSED or event == 'Exit':
        break

    elif event == 'Enter':
        run_pyinstaller(values[0])
        sg.popup("Done!", any_key_closes=True)
        window.close()

    elif event == 'Clear':
        window.find_element('out').Update('')

window.close()
